# 项目详细设计文档

## 一.系统设计

1. ### 系统设计目标及功能

我们设计的是一个简易的电影海报网站，它应当具备的功能是用户注册、用户登录、电影展示。





我们准备设计一个简易的电影海报网站，将处理后藏有flag的图片混进海报中，让攻击者通过XXE攻击获取到我们预先藏在D盘中的密码文件




1. ### 功能的具体实现







2. ### API接口设计
    
    #### ① url：/
    
    ```
    @app.route('/', methods=['GET', 'POST'])
    def login():
        if request.method == 'POST':
            return redirect('/special_login')
        else:
            return render_template('login.html')
    ```

    功能描述：该模块用于用户登录

    请求参数说明：

    请求方法说明：

    响应值说明：




    #### ② url：/registered

    ```
    @app.route('/registered', methods=['GET', 'POST'])
    def registered():
        if request.method == 'POST':
            return redirect('/special_registered')
        else:
            return render_template('registered.html')
    ```


    功能描述：

    请求参数说明：

    请求方法说明：

    响应值说明：

    #### ③ url：/homepage

    ```
    @app.route('/homepage')
    def homepage():
        return render_template('homepage.html')
    ```



    功能描述：

    请求参数说明：

    请求方法说明：

    响应值说明：

    #### ④ url：/special_registered

    ```
    @app.route('/special_registered/', methods=['GET', 'POST')
    def special_registered():
        result = None
        try:
            tree = etree.fromstring(request.data)
            # 遍历xml结构内容
            for childa in tree:
                if childa.tag == "username":
                    username = childa.text
                if childa.tag == "password":
                    password = childa.text
                if childa.tag == "repassword":
                    repassword = childa.text
            if password == repassword:
                registed_user = Registered.query.filter(Registered.user_name == username).first()
                if registed_user is not None:
                    result = "<result><code>%d</code><msg>%s</msg></result>" % (0, username)
                else:
                    hash_pwd = generate_password_hash(password)
                    registed_data = Registered(user_name=username, user_password=hash_pwd)
                    db.session.add(registed_data)
                    db.session.commit()
                    result = "<result><code>%d</code><msg>%s</msg></result>" % (1, username)
            else:
                result = "<result><code>%d</code><msg>%s</msg></result>" % (2, username)
        except Exception as Ex:
            result = "<result><code>%d</code><msg>%s</msg></result>" % (3, str(Ex))
    return result
    ```

    功能描述：

    请求参数说明：

    请求方法说明：

    响应值说明：

    #### ⑤ url：/special_login

    ```
    @app.route('/special_login', methods=['GET', 'POST'])
    def special_login():
        result = None
        try:
            tree = etree.fromstring(request.data)
            # 遍历xml结构内容
            for childa in tree:
                if childa.tag == "username":
                    username = childa.text
                if childa.tag == "password":
                    password = childa.text
            # 从数据库中取出用户数据
            user_data = Registered.query.filter(Registered.user_name == username).first()
            if user_data:
            # 对用户输入的密码再做一次哈希，与数据库中的值做比较
                if check_password_hash(user_data.user_password, password):
                    result = "<result><code>%d</code><msg>%s</msg></result>" % (1, username)
                else:
                    result = "<result><code>%d</code><msg>%s</msg></result>" % (0, username)
            else:
                result = "<result><code>%d</code><msg>%s</msg></result>" % (0, username)
        except Exception as Ex:
            result = "<result><code>%d</code><msg>%s</msg></result>" % (2, str(Ex))
    return result
    ```


    功能描述：

    请求参数说明：

    请求方法说明：

    响应值说明：







## 二.漏洞利用点设计

1. ### 漏洞介绍

指明我们要选什么漏洞做项目，简要介绍下该漏洞

2. ### 漏洞原理

讲具体原理

3. ### 漏洞应用

漏洞具体是怎么应用在项目中的



